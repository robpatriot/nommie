version: 1
rules:
  - id: dev-workflow
    scope: workspace
    text: |
      Before any pnpm commands, source `apps/backend/.env` once per shell session:
      set -a; source apps/backend/.env; set +a
      Do not source the env file repeatedly in the same shell.
      After completing backend code changes, run the linter: `pnpm be:lint`.
      After completing backend development or when testing during development, run tests: `pnpm be:test`.
      You may append additional arguments to run specific test subsets.
  - id: coding-standards
    scope: workspace
    text: |
      Follow these rules exactly. If a request would break them, stop and ask.
      No deprecated or legacy code: never use `#[deprecated]` or leave legacy/compatibility functions. Refactor callers instead.
  - id: file-operations
    scope: workspace
    text: |
      When renaming or moving files, always use `git mv` (for tracked files) or `mv` (for untracked files).
      Never manually recreate files when moving/renaming - this loses git history and makes it difficult to compare changes.
      Example: `git mv apps/backend/src/extractors/old_name.rs apps/backend/src/extractors/new_name.rs`
  - id: comments-policy
    scope: workspace
    text: |
      No commentary in edits â€” implement directly.
      Do not reference prompt artifacts in code comments. Implementation plans, step lists, or staged change descriptions provided by prompts should not appear in code comments.
      Keep comments focused on code rationale, invariants, and non-obvious behavior only.

